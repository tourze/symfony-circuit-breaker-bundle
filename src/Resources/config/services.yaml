services:
    # 基础配置
    _defaults:
        autowire: true
        autoconfigure: true
        public: false

    # 明确定义所有服务
    
    # Commands
    Tourze\Symfony\CircuitBreaker\Command\CircuitBreakerStatusCommand:
        public: true

    # Services
    Tourze\Symfony\CircuitBreaker\Service\CircuitBreakerConfigService: ~
    Tourze\Symfony\CircuitBreaker\Service\CircuitBreakerRegistry: ~
    Tourze\Symfony\CircuitBreaker\Service\CircuitBreakerService: ~
    Tourze\Symfony\CircuitBreaker\Service\CircuitBreakerHttpClient: ~
    Tourze\Symfony\CircuitBreaker\Service\MetricsCollector: ~
    Tourze\Symfony\CircuitBreaker\Service\StateManager: ~

    # Storage
    Tourze\Symfony\CircuitBreaker\Storage\MemoryStorage: ~
    Tourze\Symfony\CircuitBreaker\Storage\DoctrineStorage: ~
    Tourze\Symfony\CircuitBreaker\Storage\RedisAtomicStorage: ~
    Tourze\Symfony\CircuitBreaker\Storage\ChainedStorage: ~

    # Strategies
    Tourze\Symfony\CircuitBreaker\Strategy\StrategyManager: ~
    Tourze\Symfony\CircuitBreaker\Strategy\ConsecutiveFailureStrategy: ~
    Tourze\Symfony\CircuitBreaker\Strategy\FailureRateStrategy: ~
    Tourze\Symfony\CircuitBreaker\Strategy\SlowCallStrategy: ~

    # EventSubscribers
    Tourze\Symfony\CircuitBreaker\EventSubscriber\CircuitBreakerEventSubscriber: ~
    Tourze\Symfony\CircuitBreaker\EventSubscriber\CircuitBreakerResponseEventSubscriber: ~



    # 接口默认实现
    Tourze\Symfony\CircuitBreaker\Storage\CircuitBreakerStorageInterface:
        class: Tourze\Symfony\CircuitBreaker\Storage\MemoryStorage

    Tourze\Symfony\CircuitBreaker\Strategy\CircuitBreakerStrategyInterface:
        class: Tourze\Symfony\CircuitBreaker\Strategy\ConsecutiveFailureStrategy